<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="common.css">
    <link rel="stylesheet" href="font.css">
    <link rel="stylesheet" href="modal.css">
    <link rel="stylesheet" href="tab.css">
</head>
<body>
<div class="citrus_hills" id="citrus_hills">
    <!-- The citrus petco hills modal  -->
    <button id="findFood">Open Food Finder</button>

    <div id="citrus_petco_hills_modal" class="citrus_petco_hills_modal">

        <div class="citrus_petco_hills_modal-content">
            <span class="close">&times;</span>
            <div class="hills_modals_header flex-box">
                <div class="hills_modals_header__logo">
                    <img src="img/citrus_hills_logo.png" alt="Hill’s logo. Science did that.">
                </div>
                <h2>Find the right food for your pet</h2>
            </div>
            <div class="content-wrapper">
                <div class="hills_modals_bread flex-box">
                    <div class="bread__container flex-box">
                        <button class="bread_btn" style="display: none" onclick="showContent(event, 'tab-content')"
                                id="defaultOpen"></button>
                    </div>
                    <div id="button-start-over"></div>
                </div>
                <div class="citrus_petco_hills_modal-body">
                    <div class="search_content" id="tab-content">
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>


<script>
    let breadcrumbs = [];
    let startOver = 0;
    const animals = {
        header: 'Which type of pet do you have?',
        type: 'animal',
        items: [
            {
                title: "cat",
                id: 1,
                img: 'img/citrus-hills-cat.png',
                breadcrumb: "Pet Specifies",
                header: 'How old is your dog?',
                type: 'button',
                items: [
                    {
                        id: 2,
                        title: "0-1 year",
                        breadcrumb: "Year Range",
                        header: "Are you shopping for dry or wet food?",
                        type: 'button',
                        items: [
                            {
                                id: 3,
                                title: "dry",
                                breadcrumb: "Food Type",
                                header: "What is your dog’s breed size?",
                                type: 'button',
                                items: [
                                    {
                                        id: 4,
                                        title: "Small and toy (2–25 lb.)",
                                        breadcrumb: "Breed Size",
                                        header: "Does your dog have any specific needs?",
                                        type: 'button',
                                        items: [
                                            {
                                                id: 5,
                                                title: "weightManagement",
                                                breadcrumb: "special Notes",
                                                items: [
                                                    {
                                                        title: "Product one",
                                                        img: "https://citrusad-sebpo.github.io/Hills_FoodFinder/img/dog/citrus_hills_dog_1213032.png",
                                                        link: "test.com",
                                                        tagName: "tagging name",
                                                        cta: "Buy Now",
                                                        size: "small/Medium/"

                                                    },
                                                    {
                                                        title: "Product Two",
                                                        img: "https://citrusad-sebpo.github.io/Hills_FoodFinder/img/dog/citrus_hills_dog_1213032.png",
                                                        link: "test.com",
                                                        tagName: "tagging name",
                                                        cta: "Buy Now"

                                                    },
                                                    {
                                                        title: "Product Three",
                                                        img: "https://citrusad-sebpo.github.io/Hills_FoodFinder/img/dog/citrus_hills_dog_1213032.png",
                                                        link: "test.com",
                                                        tagName: "tagging name",
                                                        cta: "Buy Now"

                                                    },
                                                    {
                                                        title: "Product Four",
                                                        img: "https://citrusad-sebpo.github.io/Hills_FoodFinder/img/dog/citrus_hills_dog_1213032.png",
                                                        link: "test.com",
                                                        tagName: "tagging name",
                                                        cta: "Buy Now"

                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ],
                            }
                        ]
                    },

                    {
                        title: "1-6 years",
                        id: 6,
                        breadcrumb: "Year Range",
                        header: "Are you shopping for dry or wet food?",
                        type: 'button',
                        items: [
                            {
                                id: 7,
                                title: "dry",
                                breadcrumb: "Food Type",
                                header: "What is your dog’s breed size?",
                                type: 'button',
                                items: [
                                    {
                                        id: 8,
                                        title: "Small and toy (2–25 lb.)",
                                        breadcrumb: "Breed Size",
                                        header: "Does your dog have any specific needs?",
                                        type: 'button',
                                        items: [
                                            {
                                                id: 9,
                                                title: "weightManagement",
                                                breadcrumb: "Special Notes",
                                                header: "We found 4 products that fit your needs.",
                                                items: [
                                                    {
                                                        title: "Product one",
                                                        img: "https://citrusad-sebpo.github.io/Hills_FoodFinder/img/dog/citrus_hills_dog_1213032.png",
                                                        link: "test.com",
                                                        tagName: "tagging name",
                                                        cta: "Buy Now",
                                                        size: "small/Medium/"

                                                    },
                                                    {
                                                        title: "Product Two",
                                                        img: "https://citrusad-sebpo.github.io/Hills_FoodFinder/img/dog/citrus_hills_dog_1213032.png",
                                                        link: "test.com",
                                                        tagName: "tagging name",
                                                        cta: "Buy Now"

                                                    },
                                                    {
                                                        title: "Product Three",
                                                        img: "img3.png",
                                                        link: "test.com",
                                                        tagName: "tagging name",
                                                        cta: "Buy Now"

                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ],
                            }
                        ]
                    },]
            },

            {
                img: 'img/citrus-hills-dog.png',
                id: 10,
                breadcrumb: "Pet Specifies",
                title: "dog",
                items: [
                    {
                        id: 11,
                        title: "0-1 year",
                        breadcrumb: "Year Range",
                        items: [
                            {
                                id: 12,
                                title: "dry",
                                breadcrumb: "Food Type",
                                items: [
                                    {
                                        id: 13,
                                        title: "Small and toy (2–25 lb.)",
                                        breadcrumb: "Breed Size",
                                        items: [
                                            {
                                                id: 14,
                                                title: "weightManagement",
                                                breadcrumb: "special Notes",
                                                items: [
                                                    {
                                                        title: "Product one",
                                                        img: "sku.png",
                                                        link: "test.com",
                                                        tagName: "tagging name",
                                                        cta: "Buy Now",
                                                        size: "small/Medium/"

                                                    },
                                                    {
                                                        title: "Product Two",
                                                        img: "img2.png",
                                                        link: "test.com",
                                                        tagName: "tagging name",
                                                        cta: "Buy Now"

                                                    },
                                                    {
                                                        title: "Product Three",
                                                        img: "img3.png",
                                                        link: "test.com",
                                                        tagName: "tagging name",
                                                        cta: "Buy Now"

                                                    },
                                                    {
                                                        title: "Product Four",
                                                        img: "img4.png",
                                                        link: "test.com",
                                                        tagName: "tagging name",
                                                        cta: "Buy Now"

                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ],
                            }
                        ]
                    },

                    {
                        id: 15,
                        title: "1-6 years",
                        breadcrumb: "Year Range",
                        items: [
                            {
                                title: "dry",
                                breadcrumb: "Food Type",
                                items: [
                                    {
                                        title: "Small and toy (2–25 lb.)",
                                        breadcrumb: "Breed Size",
                                        items: [
                                            {
                                                title: "weightManagement",
                                                breadcrumb: "Special Notes",
                                                items: [
                                                    {
                                                        title: "Product one",
                                                        img: "sku.png",
                                                        link: "test.com",
                                                        tagName: "tagging name",
                                                        cta: "Buy Now",
                                                        size: "small/Medium/"

                                                    },
                                                    {
                                                        title: "Product Two",
                                                        img: "img2.png",
                                                        link: "test.com",
                                                        tagName: "tagging name",
                                                        cta: "Buy Now"

                                                    },
                                                    {
                                                        title: "Product Three",
                                                        img: "img3.png",
                                                        link: "test.com",
                                                        tagName: "tagging name",
                                                        cta: "Buy Now"

                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ],
                            }
                        ]
                    },]
            }
        ]
    }

    let activeItems = animals;

    function setActiveItems(item) {
        activeItems = item;
        render();
    }

    function backToSpecificBreadcrumb(index) {
        breadcrumbs = [];
        activeItems = getItemsById(animals, index, null);
        breadcrumbRender();
        render();
    }

    function getItemsById(item, id, result) {
        if (result) {
            return result;
        }
        if (item.items && item.items.length) {
            if (item.breadcrumb) {
                breadcrumbs.push({
                    title: item.breadcrumb,
                    id: item.id,
                });
            }
            item.items.filter(value => {
                if (result || value.id === id) {
                    result = result ? result : value;
                    return result;
                } else {
                    let data = getItemsById(value, id, result)
                    if (data) {
                        result = data;
                        return result;
                    }
                }
            })
            return result;
        }
    }

    function goToInitialState() {
        activeItems = animals;
        breadcrumbs = [];
        render();
        document.querySelector('.bread__container').innerHTML = ''
        document.querySelector('#button-start-over').innerHTML = '';
        startOver = 0;
    }

    function appendStartOver() {
        document.querySelector('#button-start-over').innerHTML = '<button class="reset-search" onclick="goToInitialState()">Start Over</button>';
    }

    function render() {
        let content = '';
        if (activeItems.breadcrumb) {
            breadcrumbs.push({
                title: activeItems.breadcrumb,
                id: activeItems.id,
            });
            breadcrumbRender();
        }

        if (!activeItems.type) {
            let itemsCount = activeItems.items.length;
            activeItems.header = 'We found {numberOfProduct} that fit your needs.'.replace('{numberOfProduct}', itemsCount + (itemsCount === 1 ? ' product' : ' products'))
        }

        content += `<h3>${activeItems.header ? activeItems.header : ''}</h3>
                        <div class="search-type">
                            <div class="${activeItems.type === 'animal' ? 'chose-pet' : ''} ${activeItems.type === 'button' ? 'search-type' : ''}  flex-box ${!activeItems.type ? 'products-wrapper' : ''}" >`
        activeItems.items.forEach((item, index) => {
            if (activeItems.type === 'animal') {
                content += `<a onclick='setActiveItems(${JSON.stringify(item)})' href="#" class="flex-box">
                                                    <img src="${item.img}" alt="">
                                                    <button >${item.title}</button>`
                content += index === 0 ? `</a><span>OR</span>` : ''
            } else if (activeItems.type === 'button') {
                content += `<button onclick='setActiveItems(${JSON.stringify(item)})' class="search-type-btn">${item.title}</button>`
            } else {
                content += `<a   onclick="clickTrackLink(this)" href="${item.link}" manual_cm_sp="${item.tagName}" class="flex-box">
                                        <img src="${item.img}" >
                                            <p>${item.title}</p>
                                            <div class="cta-underline">${item.cta}</div>
                                    </a>`
            }
        })
        content += ` </div>
                        </div>`;
        document.querySelector('.search_content').innerHTML = content;
    }

    ////breadcrumb initial render
    function breadcrumbRender() {
        let breadcrumb = '';
        if (breadcrumbs && breadcrumbs.length) {
            if (!startOver) {
                startOver = 1;
                appendStartOver();
            }
            breadcrumbs.forEach((bread, index) => {
                let breadIndex = bread.id;
                if (index) {
                    breadIndex = breadcrumbs[index - 1].id;
                    breadcrumb += `<button onclick="backToSpecificBreadcrumb(${breadIndex})" class="bread_btn" onclick="showContent(event, 'tab-content')" id="defaultOpen">${bread.title}</button>`
                } else {
                    breadcrumb += `<button onclick="goToInitialState()" class="bread_btn" onclick="showContent(event, 'tab-content')" id="defaultOpen">${bread.title}</button>`
                }

            })
            document.querySelector('.bread__container').innerHTML = breadcrumb;
        }
    }

    //very initial render
    render();

</script>


<script src="modal.js"></script>
<script src="tab.js"></script>

</body>
</html>